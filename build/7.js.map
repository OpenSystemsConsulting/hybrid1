{"version":3,"sources":["../../src/pages/msgs/msgs.module.ts","../../src/pages/msgs/msgs.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACd;AAalC;IAAA;IAA6B,CAAC;IAAjB,cAAc;QAX1B,+DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,uDAAQ;aACT;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,uDAAQ,CAAC;aACnC;YACD,OAAO,EAAE;gBACP,uDAAQ;aACX;SACA,CAAC;OACW,cAAc,CAAG;IAAD,qBAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfe;AACsC;AAE3B;AACa;AAEoB;AACT;AACkB;AACN;AACoB;AACvB;AAEtF;;;;;GAKG;AAOH;IAeE,kBAAmB,OAAsB,EAAS,SAAoB,EAAU,aAAoC,EAC1G,SAAmC,EAAU,SAA0B,EACvE,MAA0B,EAAU,cAAsC,EAAU,aAAoC,EACxH,oBAAkD,EAAU,wBAAqD;QAHxG,YAAO,GAAP,OAAO,CAAe;QAAS,cAAS,GAAT,SAAS,CAAW;QAAU,kBAAa,GAAb,aAAa,CAAuB;QAC1G,cAAS,GAAT,SAAS,CAA0B;QAAU,cAAS,GAAT,SAAS,CAAiB;QACvE,WAAM,GAAN,MAAM,CAAoB;QAAU,mBAAc,GAAd,cAAc,CAAwB;QAAU,kBAAa,GAAb,aAAa,CAAuB;QACxH,yBAAoB,GAApB,oBAAoB,CAA8B;QAAU,6BAAwB,GAAxB,wBAAwB,CAA6B;QAhB3H,MAAC,GAAS,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;QAE9B,cAAS,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE,UAAU,EAAE,CAAC;QACvG,QAAG,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAE9C,YAAO,GAAG,KAAK,CAAC;QAEhB,aAAQ,GAAG,EAAE,CAAC;QAUZ,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC;QAC/B,mEAAc,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QACrD,mEAAc,CAAC,aAAa,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QAC7D,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;QAC7C,IAAI,CAAC,MAAM,GAAG;YACZ,OAAO,EAAE,EAAE,cAAc,EAAE,IAAI,CAAC,QAAQ,EAAE;YAC1C,OAAO,EAAE,gBAAgB;YACzB,OAAO,EAAE,EAAE;SACZ,CAAC;IAEJ,CAAC;IACD,mCAAgB,GAAhB;QAEE,IAAI,CAAC,aAAa,CAAC,GAAG,GAAG,MAAM,CAAC;QAChC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAClC,IAAI,CAAC,WAAW,EAAE,CAAC;QAEnB,wDAAwD;QACxD,IAAI,CAAC,cAAc,CAAC,oBAAoB,EAAE,CAAC;IAC7C,CAAC;IAED,8BAAW,GAAX;QAAA,iBAUC;QATC,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,SAAS,CACvD,UAAC,IAAI;YACH,KAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,mEAAmE;QACrE,CAAC,EACD,aAAG;YACD,KAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACjB,CAAC,CACF;IACH,CAAC;IAED,kDAAkD;IAClD,+BAAY,GAAZ,UAAa,GAAG;QACd,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC;IAC3B,CAAC;IAED,sCAAmB,GAAnB,UAAoB,EAAE;QACpB,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;IACpB,CAAC;IAED,6BAAU,GAAV;QACE,IAAI,CAAC,YAAY,GAAG,sBAAsB,CAAC;QAC3C,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;IACjC,CAAC;IAED,2BAAQ,GAAR;QACE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC;QACrC,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QACxG,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;QAChC,0BAA0B;QAC1B,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC,SAAS,CAAC,CAAC;QACzD,MAAM,CAAC;QACP,qBAAqB;IACvB,CAAC;IAED,oCAAiB,GAAjB;QAAA,iBA0BC;QAzBC,IAAI,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACvC,KAAK,EAAE,qBAAqB;YAC5B,QAAQ,EAAE,+CAA+C;YACzD,OAAO,EAAE;gBACP;oBACE,IAAI,EAAE,KAAK;oBACX,OAAO,EAAE;wBACP,+CAA+C;wBAC/C,KAAI,CAAC,GAAG,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;wBAChD,MAAM,CAAC,KAAK,CAAC;oBACf,CAAC;iBACF;gBACD;oBACE,IAAI,EAAE,QAAQ;oBACd,IAAI,EAAE,QAAQ;oBACd,OAAO,EAAE;wBACP,gCAAgC;wBAChC,KAAI,CAAC,GAAG,CAAC,KAAK,CAAC,+CAA+C,CAAC,CAAC;wBAChE,MAAM,CAAC;oBACT,CAAC;iBACF;aACF;YACD,qBAAqB,EAAE,KAAK;SAC7B,CAAC,CAAC;QACH,YAAY,CAAC,OAAO,EAAE,CAAC;IACzB,CAAC,wCAAsC;IAEvC,uBAAI,GAAJ;QACE,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;QAChC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IACnB,CAAC;IA3GU,QAAQ;QAJpB,gEAAS,CAAC;YACT,QAAQ,EAAE,WAAW;WACG;SACzB,CAAC;oMAgB4B,CAAwF;YAC/F,0MAA4D;YAC/D,8HAA4C,kFAA+C,EAAqB;YAClG,KAA2F;OAlBhH,QAAQ,CA4GpB;IAAD,CAAC;AAAA;SA5GY,QAAQ,e","file":"7.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { MsgsPage } from './msgs';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    MsgsPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(MsgsPage),\r\n  ],\r\n  exports: [\r\n    MsgsPage\r\n]\r\n})\r\nexport class MsgsPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/msgs/msgs.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, AlertController, Tabs } from 'ionic-angular';\r\n\r\nimport { LoopBackConfig } from '../../../shared/sdk';\r\nimport { DespatchToDriverMessagesApi } from '../../../shared/sdk';\r\n\r\nimport { ConfigServiceProvider } from '../../providers/config-service/config-service';\r\nimport { LogServiceProvider } from '../../providers/log-service/log-service';\r\nimport { PdaparamsServiceProvider } from '../../providers/pdaparams-service/pdaparams-service';\r\nimport { MessageServiceProvider } from '../../providers/message-service/message-service';\r\nimport { DriverMessageServiceProvider } from '../../providers/driver-message-service/driver-message-service';\r\nimport { SharedServiceProvider } from '../../providers/shared-service/shared-service';\r\n\r\n/**\r\n * Generated class for the MsgsPage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-msgs',\r\n  templateUrl: 'msgs.html',\r\n})\r\nexport class MsgsPage {\r\n\r\n  t: Tabs = this.navCtrl.parent;\r\n  username: any;\r\n  logParams = { site: this.pdaParams.getSiteId(), driver: this.pdaParams.getDriverId(), fn: 'MsgsPage' };\r\n  log = this.logger.getInstance(this.logParams);\r\n  messageText;\r\n  boxShow = false;\r\n  textareadata;\r\n  messages = [];\r\n  driverId;\r\n  err;\r\n  filter;\r\n\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, private configService: ConfigServiceProvider,\r\n    private pdaParams: PdaparamsServiceProvider, private alertCtrl: AlertController,\r\n    private logger: LogServiceProvider, private messageService: MessageServiceProvider, private sharedService: SharedServiceProvider,\r\n    private driverMessageService: DriverMessageServiceProvider, private despatchToDriverMessages: DespatchToDriverMessagesApi) {\r\n    this.username = navParams.data;\r\n    LoopBackConfig.setBaseURL(this.configService.apiURL);\r\n    LoopBackConfig.setApiVersion(this.configService.API_VERSION);\r\n    this.driverId = this.pdaParams.getDriverId();\r\n    this.filter = {\r\n      \"where\": { \"drvmDriverId\": this.driverId },\r\n      \"order\": 'drvmSeqid DESC',\r\n      \"limit\": 20\r\n    };\r\n\r\n  }\r\n  ionViewWillEnter() {\r\n\r\n    this.sharedService.tab = \"Msgs\";\r\n    this.log.info(\"In the Msgs Tab.\");\r\n    this.getMessages();\r\n\r\n    // Reset new message count now they have been viewed    \r\n    this.messageService.resetNewMessageCount();\r\n  }\r\n\r\n  getMessages() {\r\n    this.despatchToDriverMessages.find(this.filter).subscribe(\r\n      (msgs) => {\r\n        this.messages = msgs;\r\n        //console.log(\"messages from inside subscribe:::\" + this.messages);\r\n      },\r\n      err => {\r\n        this.err = err;\r\n      }\r\n    )\r\n  }\r\n\r\n  // Reshow messages as required from callbacks etc.\r\n  showMessages(err) {\r\n    this.messages = this.err;\r\n  }\r\n\r\n  showMessageEntryBox(tf) {\r\n    this.boxShow = tf;\r\n  }\r\n\r\n  newMessage() {\r\n    this.textareadata = \"Input your text here\";\r\n    this.showMessageEntryBox(true);\r\n  }\r\n\r\n  onSubmit() {\r\n    this.messageText = this.textareadata;\r\n    this.driverMessageService.addMessage(this.pdaParams.getDriverId(), this.messageText, this.showMessages);\r\n    this.showMessageEntryBox(false);\r\n    //this.ionViewWillEnter();\r\n    this.navCtrl.setRoot(this.navCtrl.getActive().component);\r\n    return;\r\n    //this.getMessages();\r\n  }\r\n\r\n  deleteAllMessages() {\r\n    let confirmPopup = this.alertCtrl.create({\r\n      title: 'DELETE All messages',\r\n      subTitle: 'Are you sure you want to DELETE All messages?',\r\n      buttons: [\r\n        {\r\n          text: 'Yes',\r\n          handler: () => {\r\n            //console.log('User has DELETED all messages');\r\n            this.log.debug('User has DELETED all messages');\r\n            return false;\r\n          }\r\n        },\r\n        {\r\n          text: 'Cancel',\r\n          role: 'cancel',\r\n          handler: () => {\r\n            //console.log('Cancel clicked');\r\n            this.log.debug('User has CANCELLED out of DELETE All messages');\r\n            return;\r\n          }\r\n        }\r\n      ],\r\n      enableBackdropDismiss: false\r\n    });\r\n    confirmPopup.present();\r\n  }//End of  deleteAllMessages() messages\r\n\r\n  quit() {\r\n    this.showMessageEntryBox(false);\r\n    this.t.select(0);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/msgs/msgs.ts"],"sourceRoot":""}