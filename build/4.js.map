{"version":3,"sources":["../../src/pages/job-details/job-details.module.ts","../../src/components/components.module.ts","../../src/components/camera-button/camera-button.ts","../../src/pages/job-details/job-details.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { JobDetailsPage } from './job-details';\r\nimport { ComponentsModule } from '../../components/components.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    JobDetailsPage\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(JobDetailsPage),\r\n    ComponentsModule\r\n  ],\r\n  \r\n    exports: [\r\n      JobDetailsPage\r\n    ]\r\n})\r\nexport class JobDetailsPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/job-details/job-details.module.ts","import { NgModule } from '@angular/core';\r\nimport { CameraButtonComponent } from './camera-button/camera-button';\r\nimport { IonicModule } from 'ionic-angular';\r\n@NgModule({\r\n\tdeclarations: [CameraButtonComponent],\r\n\timports: [IonicModule],\r\n\texports: [CameraButtonComponent]\r\n})\r\nexport class ComponentsModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/components/components.module.ts","import { Component, Input } from '@angular/core';\r\n\r\nimport { ModalController } from 'ionic-angular';\r\n\r\nimport { LoopBackConfig } from '../../../shared/sdk';\r\n\r\nimport { ImageFileServiceProvider } from '../../providers/image-file-service/image-file-service';\r\nimport { ImageServiceProvider } from '../../providers/image-service/image-service';\r\nimport { ConfigServiceProvider } from '../../providers/config-service/config-service';\r\nimport { SharedServiceProvider } from '../../providers/shared-service/shared-service';\r\nimport { PdaparamsServiceProvider } from '../../providers/pdaparams-service/pdaparams-service';\r\nimport { SiteconfigServiceProvider } from '../../providers/siteconfig-service/siteconfig-service';\r\n\r\n//import { ImageTextPage } from '../../pages/image-text/image-text';\r\n\r\n/**\r\n * Generated class for the CameraButtonComponent component.\r\n *\r\n * See https://angular.io/docs/ts/latest/api/core/index/ComponentMetadata-class.html\r\n * for more info on Angular Components.\r\n */\r\n@Component({\r\n  selector: 'camera-button',\r\n  templateUrl: 'camera-button.html'\r\n})\r\nexport class CameraButtonComponent {\r\n  @Input('metadata') metadata: { basejob: '', legid: '', legStatus: '' };\r\n  imageURI;\r\n  legid;\r\n  pdaImageNotes;\r\n\r\n  constructor(public modalCtrl: ModalController, private imageFileService: ImageFileServiceProvider,\r\n    private imageService: ImageServiceProvider, private configService: ConfigServiceProvider,\r\n    private sharedService: SharedServiceProvider, private pdaParams: PdaparamsServiceProvider,\r\n    private siteConfig: SiteconfigServiceProvider) {\r\n    //console.log('Hello CameraButtonComponent Component');\r\n    LoopBackConfig.setBaseURL(configService.apiURL);\r\n    LoopBackConfig.setApiVersion(configService.API_VERSION);\r\n\r\n    // default is must enter notes for image but can be overridden by having site config set to 'N'\r\n    this.pdaImageNotes = this.pdaParams.pda_image_notes || true;\r\n    if (this.siteConfig.getSiteConfigValue('PDA_IMAGE_NOTES') === 'N')\r\n      this.pdaImageNotes = false;\r\n    //alert(\"this.pdaImageNotes from constructor of camera-button.ts:::\" + this.pdaImageNotes);\r\n  }\r\n\r\n  // function to open the modal\r\n  openModal = (obj) => {\r\n    let myModal = this.modalCtrl.create(\"ImageTextPage\", obj);\r\n    myModal.present();\r\n  };\r\n\r\n  getNotesForImage = (imageURI, legid, baseFileName, newFileName) => {\r\n    let obj = { imageURI: '', legid: 0, baseFileName: '', newFileName: '' };\r\n    obj.imageURI = imageURI;\r\n    obj.legid = legid;\r\n    obj.baseFileName = baseFileName;\r\n    obj.newFileName = newFileName;\r\n    this.openModal(obj);\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    //set the tab string in shared-service\r\n    this.sharedService.tab = \"CameraButtonComponent\";\r\n  }\r\n\r\n  takephoto = (legid) => {\r\n    //console.log(new Date().toISOString() + ': camera.takephoto: starts');\t\t//DEBUG\r\n\r\n    this.imageURI = \"Nothing Loaded!!\";\r\n    this.legid = legid;\r\n    this.imageService.takePhoto(this.legid).subscribe((imageURI) => {\r\n\r\n      this.imageURI = imageURI;\r\n      this.imageService.storeImageURI(this.legid, this.imageURI, this.metadata).subscribe((fileData) => {\r\n        // image moved to app storage\r\n        this.sharedService.imageSaved.next(fileData);\r\n        var savedImageURI = fileData.savedImageURI;\r\n        var baseFileName = fileData.baseFileName;\r\n        var newFileName = fileData.newFileName;\r\n        //alert(\"this.pdaImageNotes from inside takephoto:::\" + this.pdaImageNotes);\r\n        if (this.pdaImageNotes) {\r\n          // get the notes associated with this image\r\n          this.getNotesForImage(savedImageURI, this.legid, baseFileName, newFileName);\r\n        } else {\r\n          // no notes, simply mark as ready for upload\r\n          this.imageFileService.set(newFileName, 'readyForUpload', true);\r\n        }\r\n\r\n        //Set the shared variable multidel_phototaken to true;\r\n        this.sharedService.multidel_phototaken = true;\r\n      }, (err) => {\r\n        alert(\"storeImageURI Error\" + JSON.stringify(err));\r\n      });\r\n    });\r\n    // image successfully captured by device\r\n  }//takephoto ends here\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/camera-button/camera-button.ts","\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ModalController, AlertController, Tabs, Platform } from 'ionic-angular';\r\n\r\n/* import 'rxjs/add/operator/takeUntil';\r\nimport { Subject } from 'rxjs/Subject'; */\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport { InAppBrowser, InAppBrowserOptions } from '@ionic-native/in-app-browser';\r\n\r\nimport { LoopBackConfig } from '../../../shared/sdk';\r\nimport { Device } from '@ionic-native/device';\r\n//import { JobApi } from '../../../shared/sdk/services'; */\r\n\r\ndeclare const lbclient: any;\r\n//import { Observable } from 'rxjs/Observable';\r\nimport { Insomnia } from '@ionic-native/insomnia';\r\nimport { LogServiceProvider } from '../../providers/log-service/log-service';\r\nimport { PdaparamsServiceProvider } from '../../providers/pdaparams-service/pdaparams-service';\r\nimport { SiteconfigServiceProvider } from '../../providers/siteconfig-service/siteconfig-service';\r\nimport { BaseServiceProvider } from '../../providers/base-service/base-service';\r\nimport { SharedServiceProvider } from '../../providers/shared-service/shared-service';\r\nimport { JseaServiceProvider } from '../../providers/jsea-service/jsea-service';\r\nimport { ConfigServiceProvider } from '../../providers/config-service/config-service';\r\nimport { JobChangedServiceProvider } from '../../providers/job-changed-service/job-changed-service';\r\n\r\nimport { GpsAuditServiceProvider } from '../../providers/gps-audit-service/gps-audit-service'\r\nimport { ImageServiceProvider } from '../../providers/image-service/image-service';\r\n\r\nimport { JobnoteReplicationServiceProvider } from '../../providers/jobnote-replication-service/jobnote-replication-service';\r\nimport { NavigationServiceProvider } from '../../providers/navigation-service/navigation-service';\r\nimport { MessageServiceProvider } from '../../providers/message-service/message-service';\r\nimport { AttachServiceProvider } from '../../providers/attach-service/attach-service';\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Generated class for the JobDetailsPage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n * \r\n * Read about how to unsubscribe observables at\r\n * https://stackoverflow.com/questions/38008334/angular-rxjs-when-should-i-unsubscribe-from-subscription\r\n * \r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-job-details',\r\n  templateUrl: 'job-details.html'\r\n})\r\nexport class JobDetailsPage {\r\n  //private subscriptions = new Subscription();\r\n  private jdsub1: Subscription;\r\n  private jdsub2: Subscription;\r\n  private jdsub3: Subscription;\r\n\r\n  t: Tabs = this.navCtrl.parent;\r\n  jobMetadata;\r\n  username: any;\r\n  signature;\r\n  logParams = { site: this.pdaParams.getSiteId(), driver: this.pdaParams.getDriverId(), fn: 'JobDetailsPage' };\r\n  log = this.logger.getInstance(this.logParams);\r\n  mystr;\r\n  basejob;\r\n  basejobDate;\r\n  legs;\r\n  jobs;\r\n  discreteDelSignat;\r\n  showDelButtonNoSignat;\r\n  job;\r\n  data;\r\n  tabHeader;\r\n  note = {\r\n    'seqid': '',\r\n    'formtype': '',\r\n    'text': '',\r\n    'placeholderText': ''\r\n  };\r\n  driverId: number;\r\n  notesModal;\r\n  placeholderText;\r\n  localfilter;\r\n  isNotesModelClosed: boolean = false;\r\n  njobId;\r\n  legnum;\r\n  jobId;\r\n  results;\r\n  podname;\r\n  //loginFlag = this.pdaParams.isDrvLoggedOn();\r\n  pdaImages;\r\n  pdaNotes;\r\n  fullStatuses;\r\n  reqsNavigation;\r\n  navigationInstalled;\r\n  pdaAttachedDocs;\r\n  serverIP;\r\n  mdelPhotoTaken = false;\r\n  attachments: any = [];\r\n  PNO_CHECK = /(?:\\+?(61))? ?(?:\\((?=.*\\)))?(0?[2-57-8])\\)? ?(\\d\\d(?:[- ](?=\\d{3})|(?!\\d\\d[- ]?\\d[- ]))\\d\\d[- ]?\\d[- ]?\\d{3})/g;\r\n\r\n  // The following two are mutually exclusive so should never be set together - if they are we use depart pickup\r\n  // signature on pickup\r\n  pdaSignatOnPU = (this.pdaParams.pda_signat_on_pu || (this.siteConfig.getSiteConfigValue('PDA_SIGNATURE_PUP') == 'Y'));\r\n  pdaSignatOnDepPU;\r\n  // separate delivery signature and delivery event\r\n  pdaDiscreteDelSignat = (this.pdaParams.pda_discrete_del_signat || (this.siteConfig.getSiteConfigValue('PDA_DISCRETE_DEL_SIGNAT') == 'Y'));\r\n  multidelText = this.siteConfig.getSiteConfigValue('PDA_MULTIDEL_NOTE_TEXT');\r\n  bNewItem;\t// Just looking at an existing Job by default\r\n  jseaPerJob = (this.jseaService.getJseaConfig() == 'PJB_CHECK');\r\n  jobidparam;\r\n  pdaMandatoryPhotos = (this.pdaParams.pda_mandatory_photos || (this.siteConfig.getSiteConfigValue('PDA_MANDATORY_PHOTOS') == 'Y'));\r\n  pdaMandatoryNotes = (this.pdaParams.pda_mandatory_notes || (this.siteConfig.getSiteConfigValue('PDA_MANDATORY_NOTES') == 'Y'));\r\n  options: InAppBrowserOptions = {\r\n    location: 'yes',//Or 'no' \r\n    hidden: 'no', //Or  'yes'\r\n    clearcache: 'yes',\r\n    clearsessioncache: 'yes',\r\n    zoom: 'yes',//Android only ,shows browser zoom controls \r\n    hardwareback: 'yes',\r\n    mediaPlaybackRequiresUserAction: 'no',\r\n    shouldPauseOnSuspend: 'no', //Android only \r\n    closebuttoncaption: 'Close', //iOS only\r\n    disallowoverscroll: 'no', //iOS only \r\n    toolbar: 'yes', //iOS only \r\n    enableViewportScale: 'no', //iOS only \r\n    allowInlineMediaPlayback: 'no',//iOS only \r\n    presentationstyle: 'pagesheet',//iOS only \r\n    fullscreen: 'yes',//Windows only    \r\n  };\r\n  plt;\r\n  osplatform;\r\n  logstr;\r\n  syncInProgress;\r\n\tbreakmins;\r\n\treturnmins;\r\n  //newMessageCount: number;\r\n\r\n\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams, public modalController: ModalController,\r\n    private pdaParams: PdaparamsServiceProvider, private siteConfig: SiteconfigServiceProvider,\r\n    private logger: LogServiceProvider, private base: BaseServiceProvider, private sharedService: SharedServiceProvider,\r\n    private jseaService: JseaServiceProvider, private alertCtrl: AlertController, private jobChangedService: JobChangedServiceProvider,\r\n    private gpsAudit: GpsAuditServiceProvider, private configService: ConfigServiceProvider, private messageService: MessageServiceProvider,\r\n    private imageService: ImageServiceProvider, private jobnoteReplicationService: JobnoteReplicationServiceProvider,\r\n    private navigationService: NavigationServiceProvider, private theInAppBrowser: InAppBrowser,// private callNumber: CallNumber,\r\n    private attachService: AttachServiceProvider, public platform: Platform, private insomnia: Insomnia, private device: Device) {\r\n    //console.log(\"JobDetailsPage loading...\");\r\n    this.plt = platform;\r\n    this.username = navParams.data;\r\n    this.jobs = navParams.get('jobs');\r\n\r\n    LoopBackConfig.setBaseURL(configService.apiURL);\r\n    LoopBackConfig.setApiVersion(configService.API_VERSION);\r\n\r\n    if (this.sharedService.testing) {\r\n      this.pdaImages = true;\r\n      this.pdaNotes = true;\r\n      this.fullStatuses = true;\r\n      this.pdaSignatOnDepPU = false;\r\n    }\r\n    else {\r\n      // For button to take photos\r\n      this.pdaImages = (this.pdaParams.pda_images || (this.siteConfig.getSiteConfigValue('PDA_IMAGES') == 'Y'));\r\n      //For button to take notes\r\n      this.pdaNotes = (this.pdaParams.pda_notes || (this.siteConfig.getSiteConfigValue('PDA_NOTES') == 'Y'));\r\n      // New functionality to get arrive/depart pickup/delivery times\r\n      this.fullStatuses = (this.pdaParams.pda_full_statuses || (this.siteConfig.getSiteConfigValue('PDA_FULL_STATUSES') == 'Y'));\r\n      // signature on depart pickup \r\n      this.pdaSignatOnDepPU = (this.pdaParams.pda_signat_on_dpu || (this.siteConfig.getSiteConfigValue('PDA_SIGNATURE_DPUP') == 'Y'));\r\n    }\r\n\r\n    if (this.pdaSignatOnDepPU && this.pdaSignatOnPU) {\r\n      this.pdaSignatOnPU = false;\r\n    }\r\n\r\n    this.pdaAttachedDocs = (this.pdaParams.pda_attached_docs || (this.siteConfig.getSiteConfigValue('PDA_ATTACHED_DOCS') == 'Y'));\r\n    this.serverIP = this.configService.getServerIP();\r\n\r\n    this.driverId = this.pdaParams.getDriverId();\r\n    this.jobidparam = this.sharedService.getJobId();\r\n    this.jobMetadata = this.sharedService.getJobMetaData();\r\n    this.reqsNavigation = this.navigationService.isRequired();\r\n    this.navigationInstalled = this.navigationService.isModuleInstalled();\r\n\r\n\r\n\r\n    this.jobChangedService.setlastjobedited(false);\r\n    this.bNewItem = false;\r\n  }//Constructor ends here\r\n\r\n  ionViewDidLoad() {\r\n\r\n    //Monitor Image saves.\r\n    this.jdsub1 = this.sharedService.imageSaved.subscribe(fileData => {\r\n      // fileData contains image name and metadata with job no, legid, status\r\n      this.log.debug('imageSaved:' + JSON.stringify(fileData));\r\n      if (this.pdaMandatoryPhotos) {\r\n        var legid = fileData.metadata.legid;\t\t// id of leg of saved image\r\n        var legStatus = fileData.metadata.legStatus;\r\n        var legCount = this.jobs.length;\r\n        // find our leg and update the image status count\r\n        for (var i = 0; i < legCount; i++) {\r\n          var job = this.jobs[i];\r\n          if (legid == job.mobjobSeq) {\r\n            if (typeof job.imageCount === 'undefined') {\r\n              job.imageCount = [];\t\t// create property if it doesn't exist yet (array of objects)\r\n            }\r\n            var obj = this.getCurrentStatusObj(legStatus, job.imageCount) || {};\r\n            if (obj.count === 0)\r\n              job.imageCount.push(obj);\t\t\t// new array element\r\n            obj.count++;\r\n            job.save();\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    //Monitor job cancellations.\r\n    this.jdsub2 = this.sharedService.CANCEL.subscribe(cpayload => {\r\n      this.log.info('Received a CANCEL event');\r\n      this.log.info(cpayload.platform + ':' + JSON.stringify(cpayload));\r\n      if (typeof cpayload.data !== \"undefined\") {\r\n        if (cpayload.data.type === 'CANCEL' && cpayload.data.baseJob === this.jobs[0].mobjobBasejobNum) {\r\n          let alertPopup = this.alertCtrl.create({\r\n            title: 'Job Cancellation',\r\n            subTitle: 'A Job has Been Cancelled by Base - resyncing.',\r\n            buttons: [{\r\n              text: 'OK',\r\n              handler: () => {\r\n                const navTransition = alertPopup.dismiss();\r\n                navTransition.then(() => {\r\n                  this.t.select(0);\r\n                });\r\n                return false;\r\n              }\r\n            }],\r\n            enableBackdropDismiss: false\r\n          });\r\n          alertPopup.present();\r\n        }//inner if ends\r\n        else\r\n          this.log.info('payload.data.type <> Cancel, help !!!!');\r\n      }//outer if ends\r\n      else {\r\n        this.log.info('payload.data = undefined, help !!!!');\r\n      }\r\n    });\r\n\r\n    this.getJob();\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    console.log(\"ionViewWillEnter fired!!\")\r\n\r\n    //set the tab string in shared-service\r\n    this.sharedService.tab = \"Job Details\";\r\n\r\n    this.log.info(\"In the Job Details Page.\");\r\n\r\n    if (this.sharedService.getSyncInProgress() == true)\r\n      this.syncInProgress = true;\r\n    else\r\n      this.syncInProgress = false;\r\n  }\r\n\r\n\r\n  openSignatureModal = (legid) => {\r\n\r\n    var lparams = { metadata: { basejob: this.jobs[0].mobjobBasejobNum, legid: legid, legStatus: this.jobs[0].mobjobStatus, barcodeSignOff: false, showDeliverToBase: true } };\r\n    let modal = this.modalController.create('SignaturePage', lparams);\r\n    modal.onDidDismiss(result => {\r\n      if (typeof result !== 'undefined') {\r\n        this.podname = result.podname;\r\n        this.signature = result.signature;\r\n        this.mdelPhotoTaken = result.mdelPhotoTaken;\r\n\r\n\t\t\t\tthis.breakmins = result.breakmins;\r\n\t\t\t\tthis.returnmins = result.returnmins;\r\n\r\n        this.handleJobStatusChange(legid, this.signature, this.podname, this.breakmins, this.returnmins);\r\n\r\n        //this.signatureCallback(this.signature, this.podname, this.mdelPhotoTaken);\r\n      }\r\n    });\r\n    modal.present();\r\n  }\r\n\r\n\r\n  getJob = () => {\r\n\r\n    // Do the normal stuff for this function\r\n    this.mystr = 'getJob';\r\n    if (this.pdaParams.debug)\r\n      this.log.debug(this.mystr);\r\n    if (this.jobidparam === 'new') {\r\n      return this.newJob();\r\n    }\r\n    this.njobId = (this.jobidparam) % 100000000;\t//Modulus 100 Million gives job num and leg num - need to account for modded jobs\r\n    this.legnum = this.njobId % 100;\r\n    this.jobId = Math.trunc(this.njobId / 100);       //Divide by 100 gives job number taking off the leg number\r\n    this.localfilter =\r\n      {\r\n        \"where\": { \"mobjobBasejobNum\": this.jobId },\r\n        \"order\": 'mobjobLegNumber ASC'\r\n      };\r\n    if (this.pdaParams.jobDetailOneDayOnly) {\r\n      // convoluted (maybe) way to get job date with no hh/mm/ss into date object\r\n      var jobDate = Math.floor(this.jobidparam / 100000000);\t\t// e.g. 20160502\r\n      var year = Math.round(jobDate / 10000);\r\n      var mon = Math.round((jobDate % 10000) / 100);\r\n      var day = Math.round((jobDate % 100));\r\n      var jobDateFilter = new Date(Date.UTC(year, mon - 1, day, 0, 0, 0, 0));\r\n      this.localfilter =\r\n        {\r\n          \"where\": {\r\n            \"mobjobBasejobNum\": this.jobId,\r\n            \"mobjobBookingDay\": jobDateFilter\r\n          },\r\n          \"order\": 'mobjobLegNumber ASC'\r\n        };\r\n    }\r\n    if (this.pdaParams.isDrvLoggedOff()) {\r\n      let alertPopup = this.alertCtrl.create({\r\n        title: 'Log On/Off Issue',\r\n        subTitle: \"Please Log on to action jobs\",\r\n        buttons: [{\r\n          text: 'OK',\r\n          handler: () => {\r\n            const navTransition = alertPopup.dismiss();\r\n            navTransition.then(() => {\r\n              this.navCtrl.pop();\r\n            });\r\n            return false;\r\n          }\r\n        }],\r\n        enableBackdropDismiss: false\r\n      });\r\n      alertPopup.present();\r\n      return;\r\n    }\r\n\r\n    var Job = lbclient.models.LocalJob;\r\n    Job.find(this.localfilter, (err, results) => {\r\n      if (err) {\r\n        this.log.error('Job.find:' + JSON.stringify(err));\r\n      }\r\n\r\n      this.results = results;\r\n      if (this.results.length === 0) {\r\n        this.navCtrl.push('HomePage');\r\n        return;\r\n      }\r\n      this.legs = this.results.length;\r\n      this.jobs = this.results;\r\n      var lastleg = this.jobs[this.legs - 1];\r\n      // Check if last leg is at 'PC' status for discrete signature before delivery\r\n      if (lastleg.mobjobStatus == 'PC')\r\n        this.discreteDelSignat = true;\r\n      else\r\n        this.discreteDelSignat = false;\r\n\r\n      if (this.discreteDelSignat && this.pdaDiscreteDelSignat) {\r\n        this.showDelButtonNoSignat = true;\t\t\t// used on template in ng-if\r\n      }\r\n      this.base.base.currentItem = this.results;\r\n      this.job = this.base.base.currentItem\r\n\r\n      // Isolate the Single Job and set the CurrentItem in the Base Class...   \r\n      // Do the normal stuff for this function\r\n      this.base.currentData = this.base.combineValuesAndLabels(this.job, this.jobMetadata, \"\");\r\n      this.data = this.base.currentData;\r\n\r\n      // Set up the Metadata to control the Display of this Job...\r\n      // Set base.currentData so Edits can be sensed...\r\n      this.base.bDataChanged = false;\r\n      // No Data changed at this point...\r\n      //this.tabHeader = this.generateJobHeader(this.job);\r\n      // Generate a meaningful Header Title...\r\n\r\n      // attachments\r\n      if (this.pdaAttachedDocs) {\r\n        this.jdsub3 = this.attachService.getAttachments(results[0]).subscribe(data => {\r\n          this.attachments = data[\"filelist\"];\r\n          //console.log(\"attachments:\" + this.attachments);\r\n        }, err => {\r\n          this.log.error(\"this.attachService.getAttachments error:\" + err);\r\n          this.attachments = [];\r\n        });\r\n      }\r\n    });\r\n\r\n  }//GetJob() ends here\r\n\r\n\r\n  newJob = () => {\r\n    this.mystr = 'newJob';\r\n    //log.debug(mystr);\r\n    this.bNewItem = true;\r\n    this.job = {};\r\n    this.data = this.base.createNewItem(this.job, this.jobMetadata);\r\n    //this.data= Array.from(this.data);\r\n    this.data = this.data;\r\n    // An Empty Job with Defaults...\r\n  }\r\n\r\n  getPhoneNum(property) {\r\n    var propvalue = property.value;\r\n    //console.log(\"property.value is :::\" + propvalue);\r\n    var found = propvalue.match(this.PNO_CHECK);\r\n    return found[0].toString();\r\n\r\n  }\r\n\r\n  isPhoneNumAvailable(property) {\r\n    if ((property.property == 'mobjobAddress1') || (property.property == 'mobjobAddress2') ||\r\n      (property.property == 'mobjobAddress3') || (property.property == 'mobjobAddress4') ||\r\n      (property.property == 'mobjobAddress5')) {\r\n      var propvalue = property.value;\r\n      var found = propvalue.match(this.PNO_CHECK);\r\n      if (found != null)\r\n        return true;\r\n    }\r\n    else\r\n      //return property.value;\r\n      return false;\r\n  }\r\n\r\n  doJseaSubType = (formtype) => {\r\n    var job = this.job[0];\r\n    var jobStatus;\r\n    //formtype is MDEL or ODIM or JSEA\r\n    this.basejob = job.mobjobNumber;\r\n    this.basejobDate = job.mobjobBookingDay;\r\n    if (job.mobjobStatus == 'PU' || job.mobjobStatus == 'Dp')\r\n      jobStatus = 'PICKUP';\r\n    if (this.job[0].mobjobStatus == 'Ad')\r\n      jobStatus = 'DELIVER';\r\n    this.jseaService.setJobJseaDetails(this.basejob, this.basejobDate, 'N', jobStatus, formtype, 2);\r\n    // if MULTIDEL prompt for notes prior to entering jsea details\r\n    // designed to allow operator to enter address/suburb details\r\n    // which will then appear on CCT's invoices to clients\r\n    if (formtype == 'MULTIDEL') {\r\n      // wait for the modal form to be closed before going to the next page\r\n      if (this.isNotesModelClosed) {\r\n        if (this.pdaMandatoryPhotos) {\r\n          this.takePhoto(job.mobjobSeq, job.mobjobNumber, job.mobjobStatus);\r\n          // Keep screen on for our app\r\n          this.insomnia.keepAwake();\r\n        }\r\n\r\n        this.navCtrl.push('JseaPage').catch((err) => {\r\n          // console.log(\"Error pushing Jseapage:\" + err);\r\n        });\r\n      };\r\n      this.enterNotes(job.mobjobSeq, this.multidelText, formtype);\r\n    }\r\n    else {\r\n      this.navCtrl.push('JseaPage').catch((err) => {\r\n        //console.log(\"Error pushing Jseapage:\" + err);\r\n      });\r\n    }\r\n  }//doJseaSubType ends here\r\n\r\n\r\n  handleNavigation = function (legnum) {\r\n    var job = this.job[legnum];\r\n\r\n    if (!this.navigationInstalled) {\r\n\r\n      var alertPopup = this.alertCtrl.create({\r\n        title: 'Module not installed:',\r\n        subTitle: 'This module is not installed, please contact your office',\r\n        buttons: ['Ok'],\r\n        enableBackdropDismiss: false\r\n      });\r\n      alertPopup.present();\r\n\r\n    } else {\r\n\r\n      //var myaddr = job.mobjobClientName + ' ' + job.mobjobAddress1 + ' ' + job.mobjobSuburb;\r\n      var myaddr = job.mobjobAddress2 + ' ' + job.mobjobSuburb;\r\n\r\n      this.navigationService.registerJobDetails(job.mobjobNumber, job.mobjobBookingDay, myaddr);\r\n\r\n      this.navigationService.navigate(myaddr);\r\n    }\r\n  }\r\n  //The func below should only be called when a button is clicked EG \r\n  // Accept / Pickup / Tap to Sign \r\n  handleJobStatusChange = (seqid, signat, podname, breakmins, returnmins) => {\r\n    // seqid id the mobjobSeq of the job that's just changed e.g. 2015123103038500\r\n    this.mystr = 'handleJobStatusChange:seqid:' + seqid;\r\n    this.log.debug(this.mystr);\r\n    var jseaMaybeRequired = false;\r\n    var wasPickup = false;\r\n    var wasArriveDeliver = false;\r\n    var dateTime = new Date().getTime();\r\n    var timestamp = Math.floor(dateTime / 1000);\r\n    // Loop thru this array and update the status on all legs of the job\r\n    // jobs at this point contains all legs for one basejob\r\n    var podCount = 0;\r\n    var legCount = this.jobs.length;\r\n    //TESTING\r\n    if (this.jseaService.getJseaConfig() == 'PJB_CHECK') {\r\n      this.basejob = this.job[0].mobjobNumber;\r\n      this.basejobDate = this.job[0].mobjobBookingDay;\r\n      jseaMaybeRequired = true;\r\n    }\r\n    ///END TESTING\r\n\r\n    // If mandatory photos required check all legs to make sure at least one \r\n    // photo has been taken for the current status (anything > NJ)\r\n    // NOTE - the image could be attached to any leg\r\n    if (this.pdaMandatoryPhotos) {\r\n      var found = false;\r\n      // It's possible to have e.g. leg 0 @ Ad and leg 1 @ PC where the Ad photo\r\n      // was taken on leg 1 so get status from 1st leg ( leg 0 PU)\r\n      var jobStatus = this.jobs[0].mobjobStatus;\t// get status from 1st leg (PU)\r\n      for (var i = 0; i < legCount; i++) {\r\n        var job = this.jobs[i];\r\n        // long status text is stored in this.data\r\n        var statusString = this.getStatusString(seqid);\r\n        if (job.mobjobStatus === 'NJ') {\r\n          found = true;\t\t\t// don't care about NJ\r\n          break;\r\n        }\r\n\r\n        // [ v2.58.39 CCT test code - needs to be enabled when confirmed OK by CCT\r\n        // Maybe the \"don't care\" statuses should be configurable?\r\n        if (job.mobjobStatus === 'AC') {\r\n          found = true;\t\t\t// CCT don't care about AC\r\n          break;\r\n        }\r\n\r\n        if (job.mobjobStatus === 'Dp') {\r\n          found = true;\t\t\t// CCT don't care about Dp\r\n          break;\r\n        }\r\n        // ] v2.58.39 CCT test code end\r\n\r\n        if (typeof job.imageCount !== 'undefined') {\r\n          // We have some images - check if some for this status\r\n          var obj = this.getCurrentStatusObj(jobStatus, job.imageCount) || {};\r\n          if (obj.count > 0) {\r\n            found = true;\r\n            break;\t\t\t\t// have at least one image\r\n          }\r\n        }\r\n      }\r\n      this.log.info('pdaMandatoryPhotos: seqid:' + seqid + ', jobStatus:' + jobStatus + ', found:' + found);\r\n      if (!found) {\r\n        // no images found - don't allow user to continue\r\n        var alertPopup = this.alertCtrl.create({\r\n          title: 'No photos yet for : ' + statusString,\r\n          subTitle: \"Please take at least one photo at this stage, before updating the job status\",\r\n          buttons: ['Ok'],\r\n          enableBackdropDismiss: false\r\n        });\r\n        alertPopup.present();\r\n        return;\t\t// the alert is async - return here while popup does its job\r\n      }\r\n\r\n    }//End of pdaMandatoryPhotos check\r\n\r\n\r\n    for (var iac = 0; iac < legCount; iac++) {\r\n      var job = this.jobs[iac];\r\n      var oldStatus = job.mobjobStatus;\r\n      // Don't need to match seqid just have this there for later when\r\n      // we want to have individual signatures for each leg\r\n      // we need to change PU to PC (pod captured) for each leg of a multi leg\r\n      // job, and once all legs are PC we can the update all legs to DL\r\n\r\n      if (this.pdaParams.multileg) {\r\n        // Pod captured (PC) processing\r\n        this.log.info(\"this.fullStatuses:\" + this.fullStatuses + \" job.mobjobStatus::\" + job.mobjobStatus);\r\n\r\n        if (\r\n          (!this.fullStatuses && job.mobjobStatus == 'PU')\t\t\t// Std statuses -  NJ->AC->PU->DL\r\n          ||\r\n          (this.fullStatuses && job.mobjobStatus == 'Ad')\t\t\t// Full statuses - NJ->AC->PU->Dp->Ad->DL\r\n        ) {\r\n          // Set pickup leg status only - don't store signature etc. on this leg\r\n          // Can't let this fall thru below otherwise will become DL and not visible\r\n          // If at least one POD mark leg 0 for access by templates etc. where we only have leg 0\r\n          if (job.mobjobLegNumber == 0)\r\n            job.mobjobHasPod = true;\r\n          // Add POD for current leg only (not pickup leg 0)\r\n          if (job.mobjobSeq == seqid && job.mobjobLegNumber > 0) {\r\n            job.mobjobStatus = 'PC';\t\t// pod captured\r\n\r\n            this.mystr = 'Job status update to PC for job.mobjobLegNumber > 0 of Job Number:' + job.mobjobNumber;\r\n            this.log.info(this.mystr);\r\n\r\n            job.mobjobSignat = signat || \"\";\r\n            if (podname) {\r\n              job.mobjobPodName = podname;\r\n              job.mobjobPodTime = new Date().toISOString();\r\n            }\r\n          }\r\n\r\n          // Single leg jobs do have a pod capture on leg 0 though - need to add signat to leg 1\r\n          if (job.mobjobTotalLegs == 1 && job.mobjobLegNumber == 1) {\r\n            job.mobjobStatus = 'PC';\t\t// pod captured\r\n            this.mystr = 'Job status update to PC for leg#1 of Job Number:' + job.mobjobNumber;\r\n            this.log.info(this.mystr);\r\n            job.mobjobSignat = signat || \"\";\r\n            if (podname) {\r\n              job.mobjobPodName = podname;\r\n              job.mobjobPodTime = new Date().toISOString();\r\n            }\r\n\t\t\t\t\t\tif( breakmins !== undefined && breakmins !== '') {\r\n\t\t\t\t\t\t\tjob.breakmins = parseInt(breakmins);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif( returnmins !== undefined && returnmins !== '') {\r\n\t\t\t\t\t\t\tjob.returnmins = parseInt(returnmins);\r\n\t\t\t\t\t\t}\r\n          }\r\n\r\n          this.log.info(\"Job status for Job leg:\" + job.mobjobLegNumber + \" of Job Number:\" + job.mobjobNumber + \" is set to \" + job.mobjobStatus);\r\n        }\r\n      }\r\n\r\n      // Following block is for all legs\r\n      // TODO - should this be a switch/case?\r\n      var oldStatus = job.mobjobStatus;\r\n      if (!this.fullStatuses)\t\t\t// Original Carry way NJ->AC->PU->DL\r\n      {\r\n        if (oldStatus == 'NJ') {\r\n          job.mobjobStatus = 'AC';\r\n          job.mobjobTimeAC = Date.now();\r\n        }\r\n        else\r\n          if (oldStatus == 'AC') {\r\n            job.mobjobStatus = 'PU';\r\n            job.mobjobTimePU = Date.now();\r\n\r\n            var lgps = this.gpsAudit.getLastGPS();\r\n            if (lgps) {\r\n              job.gpsLatPU = lgps.gps_latitude;\r\n              job.gpsLongPU = lgps.gps_longitude;\r\n            }\r\n\r\n            if (job.mobjobLegNumber == 0) {\r\n              // Possible signature on pickup\r\n              job.mobjobSignat = signat || \"\";\r\n\r\n              if (podname) {\r\n                job.mobjobPodName = podname;\r\n                job.mobjobPodTime = new Date().toISOString();\r\n              }\r\n            }\r\n          }\r\n          else\r\n            if (oldStatus == 'PU') {\r\n              // PC processing - no direct route to DL now - will either be PU or PC until all pods captured\r\n              if (!this.pdaParams.multileg) {\r\n                job.mobjobStatus = 'DL';\r\n                // why did we store signature on pickup leg (leg 0)?\r\n                if (job.mobjobLegNumber > 0) {\r\n                  job.mobjobSignat = signat || \"\";\r\n                  if (podname) {\r\n                    job.mobjobPodName = podname;\r\n                    job.mobjobPodTime = new Date().toISOString();\r\n                  }\r\n\r\n\t\t\t\t\t\t\t\t\tif( breakmins !== undefined && breakmins !== '') {\r\n\t\t\t\t\t\t\t\t\t\tjob.breakmins = parseInt(breakmins);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif( returnmins !== undefined && returnmins !== '') {\r\n\t\t\t\t\t\t\t\t\t\tjob.returnmins = parseInt(returnmins);\r\n\t\t\t\t\t\t\t\t\t}\r\n                }\r\n              }\r\n            }\r\n            else\r\n              if (oldStatus == 'PC') {\r\n                podCount++;\r\n              }\r\n      }\r\n      else\t\t\t// fullStatuses - additional status steps NJ->AC->PU->Dp->Ad->DL\r\n      {\r\n        if (oldStatus == 'NJ') {\r\n          job.mobjobStatus = 'AC';\r\n          job.mobjobTimeAC = Date.now();\r\n        }\r\n        else if (oldStatus == 'AC') {\r\n          wasPickup = true;\r\n          job.mobjobStatus = 'PU';\r\n          job.mobjobTimePU = Date.now();\r\n          var lgps = this.gpsAudit.getLastGPS();\r\n          if (lgps) {\r\n            job.gpsLatPU = lgps.gps_latitude;\r\n            job.gpsLongPU = lgps.gps_longitude;\r\n          }\r\n          if (job.mobjobLegNumber == 0) {\r\n            // Possible signature on pickup\r\n            job.mobjobSignat = signat || \"\";\r\n            if (podname) {\r\n              job.mobjobPodName = podname;\r\n              job.mobjobPodTime = new Date().toISOString();\r\n            }\r\n          }\r\n        }\r\n        else\r\n          // Arrive pickup - not used atm\r\n          if (oldStatus == 'PU') {\r\n            job.mobjobStatus = 'Dp';\r\n            job.mobjobTimeDp = Date.now();\r\n            if (job.mobjobLegNumber == 0) {\r\n              // Possible signature on depart pickup\r\n              job.mobjobSignat = signat || \"\";\r\n              if (podname) {\r\n                job.mobjobPodName = podname;\r\n                job.mobjobPodTime = new Date().toISOString();\r\n              }\r\n            }\r\n          }\r\n        if (oldStatus == 'Dp') {\r\n          wasArriveDeliver = true;\r\n          job.mobjobStatus = 'Ad';\r\n          job.mobjobTimeAd = Date.now();\r\n        }\r\n        if (oldStatus == 'Ad') {\r\n          // PC processing - no direct route to DL now - will either be PU or PC until all pods captured\r\n          if (!this.pdaParams.multileg) {\r\n            // TODO - get GPS\r\n            job.mobjobStatus = 'DL';\r\n            var lgps = this.gpsAudit.getLastGPS();\r\n            if (lgps) {\r\n              job.gpsLatDL = lgps.gps_latitude;\r\n              job.gpsLongDL = lgps.gps_longitude;\r\n            }\r\n            // why did we store signature on pickup leg (leg 0)?\r\n            if (job.mobjobLegNumber > 0) {\r\n              job.mobjobSignat = signat || \"\";\r\n              if (podname) {\r\n                job.mobjobPodName = podname;\r\n                job.mobjobPodTime = new Date().toISOString();\r\n              }\r\n\t\t\t\t\t\t\tif( breakmins !== undefined && breakmins !== '') {\r\n\t\t\t\t\t\t\t\tjob.breakmins = parseInt(breakmins);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif( returnmins !== undefined && returnmins !== '') {\r\n\t\t\t\t\t\t\t\tjob.returnmins = parseInt(returnmins);\r\n\t\t\t\t\t\t\t}\r\n            }\r\n          }\r\n        }\r\n        else\r\n          if (oldStatus == 'PC') {\r\n            // if oldStatus is PC it means we've just captured a POD or, if there is \r\n            // a separate signature capture, it means we've just had a deliver event\r\n\r\n            // If we want a separate PC (signature capture) and then a discrete DEL deliver event\r\n            // don't increment podCount as we don't want to complete at this stage\r\n\r\n            // If we were at 'PC' AND we have site config set AND discreteDelSignat is set\r\n            // (last leg is at 'PC' status)\r\n            // we do want to increment podCount because we do want to complete the job now\r\n            if (this.pdaDiscreteDelSignat && !this.discreteDelSignat) {\r\n              // do nothing\r\n            }\r\n            else\r\n              if (this.showDelButtonNoSignat) {\r\n                podCount++;\r\n              }\r\n              else {\r\n                podCount++;\t\t\t// normal default behaviour\r\n              }\r\n            this.log.debug('handleJobStatusChange: ' + job.mobjobSeq + ' oldStatus:' + oldStatus + ' this.showDelButtonNoSignat:' + this.showDelButtonNoSignat + ' podCount:' + podCount);\r\n          }\r\n      }\r\n\r\n      this.mystr = 'handleJobStatusChange:' + job.mobjobSeq + ' updated from ' + oldStatus + ' -> ' + job.mobjobStatus;\r\n      this.log.info(this.mystr);\r\n      //console.log('this.mystr:::::' + this.mystr);     \r\n\r\n      if (this.sharedService.deliverToBase) {\r\n        //Set the deliverytobase field to yes\r\n        job.deliveryToBase = \"Yes\";\r\n      }\r\n\r\n      job.save();\t\t// save leg  ----------------------------------------------\r\n\r\n\r\n      this.jobChangedService.setlastjobedited(true);\r\n    }//For loop for each leg ends here\r\n\r\n    this.sharedService.deliverToBase = false;\r\n\r\n    // NOTE - because we don't replicate between the very last PC and setting all to DL the last PC leg goes\r\n    // direct from PU -> DL and therefore does NOT trigger a POD_INFORMATION event on the server\r\n\r\n    // TODO - what is best test for all PODs captured?\r\n    // if all PODs now captured update job to DL (all delivery legs have status PC so now job fully completed)\r\n    if (podCount >= (legCount - 1)) {\r\n\r\n      // check for mandatory notes here before marking job DL\r\n      if (this.pdaMandatoryNotes) {\r\n        this.enterNotes(this.jobs[0].mobjobSeq, this.multidelText, \"\");\r\n      }\r\n\r\n      for (var iac = 0; iac < legCount; iac++) {\r\n        var job = this.jobs[iac];\r\n        var oldStatus = job.mobjobStatus;\r\n        // TODO - do we need this test?  or just update every leg regardless?\r\n        if (job.mobjobStatus == 'PU' || job.mobjobStatus == 'PC' || job.mobjobStatus == 'Ad') {\r\n          // TODO - get GPS\r\n          job.mobjobStatus = 'DL';\r\n          var lgps = this.gpsAudit.getLastGPS();\r\n          if (lgps) {\r\n            job.gpsLatDL = lgps.gps_latitude;\r\n            job.gpsLongDL = lgps.gps_longitude;\r\n          }\r\n          if (this.sharedService.deliverToBase) {\r\n            //Set the deliverytobase field to yes\r\n            job.deliveryToBase = \"Yes\";\r\n          }\r\n          job.save();\t\r\n          \r\n          \r\n          // save leg         -------------------------------------------------------------\r\n          this.mystr = 'handleJobStatusChange:DL' + job.mobjobSeq + ' updated from ' + oldStatus + ' -> ' + job.mobjobStatus;\r\n          this.log.info(this.mystr);\r\n          this.jobChangedService.setlastjobedited(true);\r\n        }\r\n      }\r\n    }\r\n\r\n    //If we are here then a Jsea Form is required for a job Pu and Del\r\n    // So now check if is a pickup etc\r\n    if (jseaMaybeRequired && (wasPickup || wasArriveDeliver)) {\r\n      var lstr;\r\n      if (wasPickup)\r\n        lstr = 'PICKUP';\r\n      else\r\n        lstr = 'DELIVER';\r\n      this.jseaService.setJobJseaDetails(this.basejob, this.basejobDate, 'N', lstr, 'JSEA', 1);\r\n      this.navCtrl.push('JseaPage');\r\n      return;\r\n    }\r\n    // After save go back to job list\r\n    // this.navCtrl.pop();\r\n    //this.navCtrl.setRoot(TabsPage);\r\n    this.t.select(0);\r\n    return;\r\n  }//END OF handleJobStatusChange function ends here\r\n\r\n  jnSyncCallback = (err, conflicts) => {\r\n    if (err)\r\n      this.log.error('jnSyncCallback: err:' + err);\r\n    if (conflicts)\r\n      this.log.error('jnSyncCallback: conflicts:' + conflicts);\r\n  };\r\n\r\n\r\n  openNotesModal(note: {}) {\r\n\r\n    this.notesModal = this.modalController.create('JobDetailNotesPage', { 'note': note });\r\n    this.notesModal.onDidDismiss(result => {\r\n      if (typeof result !== 'undefined') {\r\n        var seqid = result.seqid;\r\n        var noteText = result.noteText;\r\n        this.saveNotes(seqid, noteText);\r\n      }\r\n    });\r\n    this.notesModal.present();\r\n  }\r\n\r\n  enterNotes(seqid, placeholder, formtype) {\r\n    // TODO - do we need to save seqid?  Should all be in job[0]  \r\n    this.note.seqid = seqid;\r\n    this.note.placeholderText = placeholder || \"Enter job notes here\";\r\n    this.note.formtype = formtype || \"\";\r\n    this.openNotesModal(this.note);\r\n  }\r\n\r\n  saveNotes = (seqid, noteText) => {\r\n    var LocalNote = lbclient.models.LocalNote;\r\n    var seqid = seqid;\r\n    //var note = noteText;\r\n    var ln = new LocalNote();\r\n    ln.jnJobNum = this.job[0].mobjobNumber;\r\n    ln.jnJobBday = this.job[0].mobjobBookingDay;\r\n    // prepend formtype if set e.g. \"MULTIDEL:....\"\r\n    if (this.note.formtype)\r\n      ln.jnText = this.note.formtype + ':' + noteText;\r\n    else\r\n      ln.jnText = noteText;\r\n    ln.jnDriver = this.pdaParams.getDriverId();\r\n    ln.jnCreateTime = Date.now();\r\n    ln.save();\r\n    //this.job_note_sync(this.jnSyncCallback);\r\n    this.jobnoteReplicationService.job_note_sync(this.jnSyncCallback, \"\");\r\n\r\n  }\r\n\r\n  getCurrentStatusObj = (legStatus, imageCountArr) => {\r\n    for (var i = 0; i < imageCountArr.length; i++) {\r\n      if (imageCountArr[i].jobStatus === legStatus) {\r\n        return imageCountArr[i];\r\n      }\r\n    }\r\n    return { \"jobStatus\": legStatus, \"count\": 0 };\r\n  }\r\n\r\n  getStatusString = (seqid) => {\r\n    var len = this.data.length;\r\n    for (var i = 0; i < len; i++) {\r\n      if (this.data[i].legid === seqid && this.data[i].property === 'mobjobStatus') {\r\n        return (this.data[i].enumValue.label);\r\n      }\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  checkOkForSignat = (seqid) => {\r\n    // check if images taken at this status to allow signature to go ahead\r\n    // This function is called from the signature pad directive \r\n    var retval = true;\t\t\t// default behaviour\r\n    var statusString;\r\n    var legid;\r\n    if (this.pdaMandatoryPhotos) {\r\n      // this.job contains the list of legs - 1st should match seqid\r\n      this.log.debug(\"checkOkForSignat:pdaMandatoryPhotos: leg 0:\" + this.job[0].mobjobSeq + \", seqid:\" + seqid);\r\n      if (this.job[0].mobjobSeq === seqid) {\r\n        retval = false;\r\n        var jobStatus;\r\n        var legCount = this.job.length;\r\n        for (var i = 0; i < legCount; i++) {\r\n          var job = this.job[i];\r\n          jobStatus = job.mobjobStatus;\r\n          legid = job.legid;\r\n          // long status text is stored in this.data\r\n          statusString = this.getStatusString(seqid);\r\n          if (job.mobjobStatus === 'NJ') {\r\n            retval = true;\t\t\t// don't care about NJ\r\n            break;\r\n          }\r\n\r\n          if (typeof job.imageCount !== 'undefined') {\r\n            // We have some images - check if some for this status\r\n            var obj = this.getCurrentStatusObj(job.mobjobStatus, job.imageCount) || {};\r\n            if (obj.count > 0) {\r\n              retval = true;\r\n              break;\t\t\t\t// have at least one image\r\n            }\r\n          }\r\n        }\r\n      }\r\n      if (!retval) {\r\n        // no images found - don't allow operator to continue\r\n        var alertPopup = this.alertCtrl.create({\r\n          title: 'No photos yet for : ' + statusString,\r\n          subTitle: \"Please take at least one photo at this stage, before updating the job status\",\r\n          buttons: ['Ok'],\r\n          enableBackdropDismiss: false\r\n        });\r\n        alertPopup.present();\r\n        return;\t\t// the alert is async - return here while popup does its job\r\n      }\r\n    }\r\n\r\n    if (retval)\r\n      this.openSignatureModal(seqid);\r\n\r\n\r\n  }//checkOkForSignat ends here\r\n\r\n\r\n\r\n  takePhoto = (legid, basejob, jobstatus) => {\r\n    // function similar to that in imageCapture directive to take and store a photo\r\n    // note that this is only for CCT atm and they don't require notes for photos\r\n    this.imageService.takePhoto(legid).then(function (imageURI) {\r\n      // image successfully captured by device\r\n      // create metadata object with at least legid, basejob and legStatus properties\r\n      // which are used on the remote endpoint for reference in job_mobile_events table\r\n      var metadata = {\r\n        legid: legid,\r\n        basejob: basejob,\r\n        legStatus: jobstatus\r\n      };\r\n\r\n      this.imageService.storeImageURI(legid, imageURI, metadata).then(function (fileData) {\r\n        // image moved to app storage\r\n        this.imageFileService.set(fileData.newFileName, 'notes', 'MULTIDEL');\r\n        this.imageFileService.set(fileData.newFileName, 'readyForUpload', true);\r\n\r\n        this.sharedService.imageSaved.next(fileData);\r\n\r\n      }, function (err) {\r\n        this.log.error(JSON.stringify(err));\r\n      });\r\n\r\n    }, function (err) {\r\n      this.log.error(JSON.stringify(err));\r\n    });\r\n  }\r\n\r\n  public openWithBrowser(filename: string) {\r\n    if (this.serverIP == '')\r\n      this.serverIP = JSON.parse(localStorage.getItem('clientConfig')).serverIP;\r\n\r\n    var url = 'http://' + this.serverIP + '/docs/' + this.jobs[0].mobjobClientCode + '/' + filename;\r\n    var target;\r\n\r\n    this.plt.ready().then((readySource) => {\r\n      this.osplatform = this.device.platform;\r\n      if (this.osplatform != null) {\r\n\r\n        this.osplatform = this.osplatform.toLowerCase();\r\n        if (this.osplatform.localeCompare('ios') == 0)\r\n          target = \"_blank\";\r\n        else\r\n          target = \"_system\";\r\n      }\r\n      else\r\n        target = \"_system\";\r\n\r\n      this.theInAppBrowser.create(url, target, this.options);\r\n    });\r\n  }\r\n\r\n  trackByFn(index, property) {\r\n    return property.index;\r\n  }\r\n\r\n  ionViewWillUnload() {\r\n    this.jdsub1.unsubscribe();\r\n    this.jdsub2.unsubscribe();\r\n\r\n    if (this.pdaAttachedDocs)\r\n      this.jdsub3.unsubscribe();\r\n\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/job-details/job-details.ts"],"sourceRoot":""}